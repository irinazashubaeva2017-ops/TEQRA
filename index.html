<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TEQRA | Premium Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --accent: #00f0ff; --bg: #05070a; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        .cyber-card { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(0, 240, 255, 0.1); backdrop-filter: blur(12px); transition: 0.3s; }
        .cyber-card:hover { border-color: var(--accent); box-shadow: 0 0 20px rgba(0, 240, 255, 0.15); }
        .btn-primary { background: linear-gradient(90deg, #06b6d4, #3b82f6); transition: 0.3s; }
        .btn-primary:active { transform: scale(0.95); }
        .loader { border: 2px solid #f3f3f3; border-top: 2px solid var(--accent); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; vertical-align: middle; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <nav class="sticky top-0 z-50 p-4 border-b border-white/5 bg-black/50 backdrop-blur-xl flex justify-between items-center">
        <div class="text-2xl font-black tracking-tighter text-cyan-400 cursor-pointer" id="logo">TEQRA</div>
        <div class="flex items-center gap-4">
            <div class="relative cursor-pointer" id="cartTrigger">
                <span class="text-sm uppercase font-bold text-gray-400">–ö–æ—à–∏–∫</span>
                <span id="cartCount" class="absolute -top-2 -right-3 bg-cyan-500 text-[10px] px-1.5 rounded-full text-black font-black">0</span>
            </div>
            <button id="adminBtn" class="opacity-30 hover:opacity-100 transition">‚ö°</button>
        </div>
    </nav>

    <main id="app" class="p-4 max-w-7xl mx-auto min-h-screen">
        
        <section id="view-catalog">
            <h2 class="text-3xl font-light mb-8 italic uppercase tracking-widest text-white/80">–ù–æ—É—Ç–±—É–∫–∏</h2>
            <div id="catalog-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            <div id="empty-state" class="hidden text-center py-20">
                <div class="text-6xl mb-4">üõ∏</div>
                <p class="text-cyan-400">–¢–æ–≤–∞—Ä–∏ –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ... –ù–æ—É—Ç–±—É–∫–∏ –ø–æ–ª–µ—Ç—ñ–ª–∏ –≤ –∫–æ—Å–º–æ—Å!</p>
            </div>
        </section>

        <section id="view-admin" class="hidden max-w-xl mx-auto py-10">
            <div class="bg-slate-900/50 p-8 rounded-3xl border border-white/10">
                <h2 class="text-2xl font-bold mb-6 text-cyan-400">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</h2>
                <div class="space-y-4">
                    <input type="text" id="inp-model" placeholder="–ë—Ä–µ–Ω–¥ —Ç–∞ –º–æ–¥–µ–ª—å" class="w-full bg-black/40 border border-white/10 p-4 rounded-xl focus:border-cyan-500 outline-none">
                    <input type="number" id="inp-price" placeholder="–¶—ñ–Ω–∞ (–≥—Ä–Ω)" class="w-full bg-black/40 border border-white/10 p-4 rounded-xl focus:border-cyan-500 outline-none">
                    <textarea id="inp-specs" placeholder="–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—á–µ—Ä–µ–∑ –∫–æ–º—É)" class="w-full bg-black/40 border border-white/10 p-4 rounded-xl focus:border-cyan-500 outline-none h-32"></textarea>
                    
                    <div class="relative group">
                        <input type="file" id="inp-file" class="hidden">
                        <label for="inp-file" class="block w-full text-center p-4 border-2 border-dashed border-white/10 rounded-xl cursor-pointer hover:border-cyan-500/50 transition">
                            <span id="file-label">–û–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ –∑ –≥–∞–ª–µ—Ä–µ—ó</span>
                        </label>
                    </div>

                    <button id="submit-product" class="w-full btn-primary p-4 rounded-xl font-black uppercase tracking-widest mt-4">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–∞ —Å–∞–π—Ç—ñ</button>
                    <button id="back-to-site" class="w-full text-gray-500 text-sm py-2">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω</button>
                </div>
            </div>
        </section>

        <section id="view-cart" class="fixed inset-0 bg-black/90 z-[100] hidden p-6 flex flex-col">
            <div class="flex justify-between items-center mb-10">
                <h2 class="text-4xl font-black uppercase">–¢–≤–æ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
                <button id="closeCart" class="text-5xl font-light">&times;</button>
            </div>
            <div id="cart-list" class="flex-1 overflow-y-auto space-y-6"></div>
            <div class="pt-6 border-t border-white/10">
                <div class="flex justify-between text-2xl font-bold mb-6">
                    <span>–†–∞–∑–æ–º:</span>
                    <span id="cart-total">0 ‚Ç¥</span>
                </div>
                <button id="checkoutBtn" class="w-full btn-primary p-5 rounded-2xl font-black text-xl uppercase tracking-tighter">–ó–∞–º–æ–≤–∏—Ç–∏ –∑–∞—Ä–∞–∑</button>
            </div>
        </section>

    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // –¢–≤–æ—ó –¥–∞–Ω—ñ
        const firebaseConfig = {
            apiKey: "AIzaSyCuYjKFAsKbdu_PLI4OkxiW6Wz-Yhq_q44",
            databaseURL: "https://catalog-b9cc2-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "catalog-b9cc2",
            storageBucket: "catalog-b9cc2.firebasestorage.app"
        };
        const IMGBB_KEY = "70bb1de10d70f62410bc55ddd2a4fd0e";

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        let cart = JSON.parse(localStorage.getItem('teqra_cart') || '[]');

        // DOM Elements
        const views = {
            catalog: document.getElementById('view-catalog'),
            admin: document.getElementById('view-admin'),
            cart: document.getElementById('view-cart')
        };

        const switchView = (target) => {
            Object.values(views).forEach(v => v.classList.add('hidden'));
            views[target].classList.remove('hidden');
            window.scrollTo(0,0);
        };

        // –†–µ–∞–ª—Ç–∞–π–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—É
        onValue(ref(db, "products"), (snapshot) => {
            const grid = document.getElementById('catalog-grid');
            const empty = document.getElementById('empty-state');
            const data = snapshot.val();
            
            grid.innerHTML = "";
            if (!data) {
                empty.classList.remove('hidden');
                return;
            }
            
            empty.classList.add('hidden');
            Object.entries(data).forEach(([id, item]) => {
                const card = document.createElement('div');
                card.className = "cyber-card p-4 rounded-3xl flex flex-col";
                card.innerHTML = `
                    <div class="h-56 rounded-2xl overflow-hidden mb-4 bg-black/20">
                        <img src="${item.image}" class="w-full h-full object-cover" loading="lazy">
                    </div>
                    <h3 class="text-xl font-bold mb-1">${item.model}</h3>
                    <p class="text-xs text-gray-400 flex-1 line-clamp-3 mb-4 font-mono uppercase">${item.specs}</p>
                    <div class="flex justify-between items-center mt-auto">
                        <span class="text-2xl font-black text-cyan-400">${item.price} ‚Ç¥</span>
                        <button class="add-to-cart-btn bg-white text-black px-6 py-2 rounded-xl font-bold text-sm hover:bg-cyan-400 transition" 
                                data-product='${JSON.stringify({id, ...item})}'>–ö–£–ü–ò–¢–ò</button>
                    </div>
                `;
                grid.appendChild(card);
            });

            // –ù–∞–≤—ñ—à—É—î–º–æ –∫–ª—ñ–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.onclick = () => {
                    const product = JSON.parse(btn.getAttribute('data-product'));
                    cart.push(product);
                    updateCart();
                };
            });
        });

        // –†–æ–±–æ—Ç–∞ –∑ –∫–æ—à–∏–∫–æ–º
        const updateCart = () => {
            localStorage.setItem('teqra_cart', JSON.stringify(cart));
            document.getElementById('cartCount').innerText = cart.length;
            renderCartItems();
        };

        const renderCartItems = () => {
            const list = document.getElementById('cart-list');
            const totalEl = document.getElementById('cart-total');
            list.innerHTML = "";
            let total = 0;

            cart.forEach((item, index) => {
                total += parseInt(item.price);
                list.innerHTML += `
                    <div class="flex gap-4 items-center bg-white/5 p-4 rounded-2xl">
                        <img src="${item.image}" class="w-20 h-20 object-cover rounded-lg">
                        <div class="flex-1">
                            <p class="font-bold">${item.model}</p>
                            <p class="text-cyan-400">${item.price} ‚Ç¥</p>
                        </div>
                        <button onclick="removeCartItem(${index})" class="text-red-500 text-2xl">&times;</button>
                    </div>
                `;
            });
            totalEl.innerText = `${total} ‚Ç¥`;
        };

        window.removeCartItem = (index) => {
            cart.splice(index, 1);
            updateCart();
        };

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—É
        document.getElementById('submit-product').onclick = async () => {
            const btn = document.getElementById('submit-product');
            const model = document.getElementById('inp-model').value;
            const price = document.getElementById('inp-price').value;
            const specs = document.getElementById('inp-specs').value;
            const file = document.getElementById('inp-file').files[0];

            if(!model || !price || !file) return alert("–ó–∞–ø–æ–≤–Ω–∏ –≤—Å—ñ –ø–æ–ª—è —ñ –¥–æ–¥–∞–π —Ñ–æ—Ç–æ!");

            btn.disabled = true;
            btn.innerHTML = `<span class="loader"></span> –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä...`;

            try {
                // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ ImgBB
                const formData = new FormData();
                formData.append("image", file);
                const imgRes = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`, { method: "POST", body: formData });
                const imgData = await imgRes.json();
                
                // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ Firebase
                await push(ref(db, "products"), {
                    model, price, specs, image: imgData.data.url, createdAt: Date.now()
                });

                alert("–¢–æ–≤–∞—Ä —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ –≤ –∫–∞—Ç–∞–ª–æ–≥!");
                switchView('catalog');
                // –û—á–∏—Å—Ç–∫–∞
                document.getElementById('inp-model').value = "";
                document.getElementById('inp-price').value = "";
                document.getElementById('inp-specs').value = "";
            } catch (err) {
                alert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –ü–µ—Ä–µ–≤—ñ—Ä –∫–æ–Ω—Å–æ–ª—å.");
                console.error(err);
            } finally {
                btn.disabled = false;
                btn.innerText = "–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–∞ —Å–∞–π—Ç—ñ";
            }
        };

        // Event Listeners (–ö–ª—ñ–∫–∏)
        document.getElementById('adminBtn').onclick = () => {
            const pass = prompt("–î–æ—Å—Ç—É–ø –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤ TEQRA. –í–≤–µ–¥—ñ—Ç—å –∫–æ–¥:");
            if(pass === "teqra2026") switchView('admin');
        };

        document.getElementById('logo').onclick = () => switchView('catalog');
        document.getElementById('back-to-site').onclick = () => switchView('catalog');
        document.getElementById('cartTrigger').onclick = () => views.cart.classList.remove('hidden');
        document.getElementById('closeCart').onclick = () => views.cart.classList.add('hidden');
        
        document.getElementById('inp-file').onchange = (e) => {
            document.getElementById('file-label').innerText = e.target.files[0].name;
        };

        document.getElementById('checkoutBtn').onclick = () => {
            if(cart.length === 0) return alert("–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π");
            const phone = prompt("–¢–≤—ñ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –¥–ª—è –∑–≤'—è–∑–∫—É:");
            if(phone) {
                alert("–î—è–∫—É—î–º–æ! –†—ñ–Ω–∞ –∞–±–æ –ú—ñ—à–∞ –∑–≤'—è–∂—É—Ç—å—Å—è –∑ —Ç–æ–±–æ—é –Ω–∞–π–±–ª–∏–∂—á–∏–º —á–∞—Å–æ–º.");
                cart = [];
                updateCart();
                views.cart.classList.add('hidden');
            }
        };

        // –ü–æ—á–∞—Ç–∫–æ–≤–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        updateCart();

    </script>
</body>
</html>
