<script>
/* ===== PARTICLES ===== */
const p=document.getElementById('particles');
for(let i=0;i<70;i++){
  const d=document.createElement('div');
  d.className='particle';
  const s=Math.random()*3+1;
  d.style.width=s+'px';
  d.style.height=s+'px';
  d.style.left=Math.random()*100+'%';
  d.style.animationDuration=15+Math.random()*25+'s';
  d.style.animationDelay=Math.random()*-30+'s';
  p.appendChild(d);
}

/* ===== AUDIO SYSTEM ===== */
let audioCtx;

function playBootSound(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  }

  const now = audioCtx.currentTime;

  // MAIN HUM
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = "sine";
  osc.frequency.setValueAtTime(90, now);
  osc.frequency.exponentialRampToValueAtTime(220, now + 1.2);

  gain.gain.setValueAtTime(0.001, now);
  gain.gain.exponentialRampToValueAtTime(0.25, now + 0.4);
  gain.gain.exponentialRampToValueAtTime(0.0001, now + 1.5);

  osc.connect(gain).connect(audioCtx.destination);
  osc.start(now);
  osc.stop(now + 1.6);

  // WHOOSH
  const noise = audioCtx.createBufferSource();
  const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate * 1.2, audioCtx.sampleRate);
  const data = buffer.getChannelData(0);
  for(let i=0;i<data.length;i++){
    data[i]=(Math.random()*2-1)*(1-i/data.length);
  }
  noise.buffer = buffer;

  const noiseGain = audioCtx.createGain();
  noiseGain.gain.setValueAtTime(0.0001, now + 0.8);
  noiseGain.gain.exponentialRampToValueAtTime(0.15, now + 1);
  noiseGain.gain.exponentialRampToValueAtTime(0.0001, now + 1.4);

  noise.connect(noiseGain).connect(audioCtx.destination);
  noise.start(now + 0.7);
  noise.stop(now + 1.5);
}

/* ===== LAUNCH ===== */
const btn=document.getElementById('btn');
const boot=document.getElementById('boot');
const home=document.getElementById('home');
const power=document.getElementById('power');

btn.onclick=()=>{
  playBootSound();

  power.classList.add('launch');

  setTimeout(()=>{
    boot.style.opacity=0;
    boot.style.transform='scale(1.6)';
    setTimeout(()=>{
      boot.style.display='none';
      home.style.opacity=1;
      home.style.pointerEvents='auto';
      home.style.transform='scale(1)';
      home.style.filter='blur(0)';
    },600);
  },800);
};
</script>
